<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Fair-Gameâ„¢ | Shop</title>
  <link rel="stylesheet" href="./Styles/shop.css" />
  <link rel="shortcut icon" href="./Images/logo/Artboard_1.png" type="image/x-icon" />
</head>
<body>
  <header>
    <img class="logoImg" src="./Images/logo/Artboard_1.png" alt="Fair Game Icon"/>
    <img class="logo"    src="./Images/logo/Fair-GameLogo.png" alt="Fair Game Logo"/>
    <nav class="nav">
      <a class="navItem" href="./index.html">Home</a>
      <a class="navItem Shop" href="./shop.html">Shop</a>
      <a class="navItem" href="./Blog.html">Blog</a>
      <a id="loginButton" href="./login.html">Log In</a>
      <a class="navItem contact" href="./contact.html">Contact Us</a>
    </nav>
  </header>

  <main>
    <div class="shopName">
      <h1 class="shopTitle">Fair Shop</h1>
      <a class="cart" href="#"><img src="./Social-Icons/grocery-store.png" alt="Cart" /></a>
    </div>
    <div id="product-list" class="product-grid"></div>
  </main>

  <footer>
    <p>&copy; 2024 Fair Shop. All rights reserved.</p>
  </footer>

  <!-- 1) Auth toggle (Log In / Log Out) -->
  <script src="./javaScript/authCheck.js" defer></script>

  <!-- 2) Shopify Buy SDK (from unpkg, polyfilled UMD build) -->
  <script src="https://unpkg.com/shopify-buy@2.16.0/dist/shopify-buy.umd.polyfilled.min.js" defer></script>

  <!-- 3) Your inline shop logic -->
  <script defer>
    document.addEventListener('DOMContentLoaded', async () => {
      // initialize the SDK
      const client = ShopifyBuy.buildClient({
        domain: 'rjm8c1-8r.myshopify.com',            // your-shop.myshopify.com
        storefrontAccessToken: 'ecda633eb93407dde1804cb0f72ff531'
      });

      // fetch all products
      const products = await client.product.fetchAll();

      // render them
      const list = document.getElementById('product-list');
      products.forEach(product => {
        const card = document.createElement('div');
        card.className = 'product-item';
        card.innerHTML = `
          ${product.images[0]
            ? `<img class="product-Img" src="${product.images[0].src}" alt="${product.title}" />`
            : ''}
          <h3 class="product-Name">${product.title}</h3>
          <p class="product-Price">${product.variants[0].price} ${product.variants[0].presentmentCurrencyCode}</p>
          <button class="buy-btn">Buy Now</button>
        `;
        list.appendChild(card);

        // buy button handler
        card.querySelector('.buy-btn').addEventListener('click', async () => {
          let checkout = await client.checkout.create();
          checkout = await client.checkout.addLineItems(checkout.id, [{
            variantId: product.variants[0].id,
            quantity: 1
          }]);
          window.location.href = checkout.webUrl;
        });
      });
    });
  </script>
</body>
</html>
